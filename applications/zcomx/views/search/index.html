{{from applications.zcomx.modules.search import Search}}
{{extend 'layout_main.html'}}

<div id="front_page">

{{=LOAD(c='default', f='top', extension='load', ajax=False, content='')}}

{{
viewbys = ['list', 'tile']
icons = {'list': 'th-list', 'tile': 'th-large'}
viewby = request.vars.view if request.vars.view and request.vars.view in viewbys else 'list' if request.vars.o == 'creators' else 'tile'
}}

<div class="row" id="options_section">
    <div class="col-sm-12" id="options_container">
        <div class="list_tile_options">
            <div class="btn-group">
            {{for v in viewbys:}}
                {{viewby_vars = dict(request.vars)}}
                {{viewby_vars['view'] = v}}
                {{disabled = 'disabled' if v == viewby else 'active'}}
                <a class="btn btn-default btn-lg {{=disabled}}" type="button"href="{{=URL(r=request, vars=viewby_vars)}}">
                    <span class="glyphicon glyphicon-{{=icons[v]}}"></span>
                </a>
            {{pass}}
            </div>
        </div>
        <ul class="nav nav-tabs">
        {{order_fields = Search.order_fields}}
        {{orderbys = order_fields.keys()}}
        {{orderby = request.vars.o if request.vars.o in orderbys else orderbys[0]}}
        {{for o in orderbys:}}
            <li class="nav-tab {{if o == orderby:}}active{{pass}}">
                {{orderby_vars = dict(request.vars)}}
                {{orderby_vars['o'] = o}}
                {{label = Search.label(o, 'tab_label')}}
                <a href="{{=URL(r=request, vars=orderby_vars)}}">{{=label}}</a>
            </li>
        {{pass}}
        </ul>
    </div>
</div>

<div class="grid_section">
{{func = '{v}_grid'.format(v=viewby)}}
{{=LOAD(c='search', f=func, args=request.args, vars=request.vars, extension='load', ajax=True)}}
</div>

</div>
